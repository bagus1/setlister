<!doctype html>
<html>
  <head>
    <title>Peaks.js Test</title>
  </head>
  <body>
    <h1>Peaks.js Test</h1>
    <div id="test-results"></div>

    <!-- Load dependencies -->
    <script src="/js/konva.min.js"></script>
    <script src="/js/waveform-data.min.js"></script>
    <script src="/js/peaks.min.js"></script>

    <script>
      console.log("Testing Peaks.js availability...");

      const results = document.getElementById("test-results");

      function addResult(message, success) {
        const div = document.createElement("div");
        div.style.color = success ? "green" : "red";
        div.textContent = (success ? "✅" : "❌") + " " + message;
        results.appendChild(div);
      }

      if (typeof Peaks !== "undefined") {
        addResult("Peaks.js is available: " + typeof Peaks, true);
        addResult("Peaks.init function: " + typeof Peaks.init, true);
      } else {
        addResult("Peaks.js is not available", false);
      }

      if (typeof Konva !== "undefined") {
        addResult("Konva is available: " + typeof Konva, true);
      } else {
        addResult("Konva is not available", false);
      }

      if (typeof WaveformData !== "undefined") {
        addResult("WaveformData is available: " + typeof WaveformData, true);
      } else {
        addResult("WaveformData is not available", false);
      }

      // Test if we can create a simple Peaks instance
      if (typeof Peaks !== "undefined") {
        try {
          // This will fail but should give us more info
          Peaks.init(
            {
              container: document.body,
              mediaElement: null,
            },
            function (error, peaks) {
              if (error) {
                addResult("Peaks.init test error: " + error.message, false);
              } else {
                addResult("Peaks.init test successful!", true);
              }
            }
          );
        } catch (e) {
          addResult("Peaks.init test exception: " + e.message, false);
        }
      }
    </script>
  </body>
</html>
