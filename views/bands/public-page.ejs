<style>
    .hero-section {
        background: #343a40;
        color: #e9ecef;
        padding: 30px 30px 30px 30px;
        margin-bottom: 40px;
    }
    .hero-section .tagline {
        font-size: 1.25rem;
        opacity: 0.9;
    }
    .section-title {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 30px;
        padding-bottom: 10px;
        border-bottom: 3px solid #667eea;
    }
    .photo-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    .photo-card img {
        width: 100%;
        height: 250px;
        object-fit: cover;
        border-radius: 8px;
    }
    .member-card {
        text-align: center;
        margin-bottom: 30px;
    }
    .member-card img {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 15px;
    }
    .press-quote {
        background: #f8f9fa;
        padding: 30px;
        border-left: 4px solid #667eea;
        margin-bottom: 20px;
        border-radius: 5px;
    }
    .press-quote blockquote {
        font-size: 1.1rem;
        font-style: italic;
        margin-bottom: 15px;
    }
    .social-links a {
        font-size: 2rem;
        margin: 0 15px;
        color: #667eea;
        transition: color 0.3s;
    }
    .social-links a:hover {
        color: #764ba2;
    }
    .gig-card {
        border-left: 4px solid #667eea;
        padding: 15px;
        margin-bottom: 15px;
        background: #f8f9fa;
    }
    .logo-card:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
</style>

<!-- Hero Section -->
<div class="hero-section">
    <% 
    // Find primary logo
    const primaryLogo = band.photos && band.photos.find(p => p.category === 'logo' && p.isPrimary);
    %>
    
    <div class="container" id="heroContainer">
        <% if (primaryLogo) { %>
            <!-- Logo will be positioned by JS based on aspect ratio -->
            <div id="logoContainer" class="mb-3">
                <img id="primaryLogo" src="<%= primaryLogo.filePath %>" alt="<%= band.name %> Logo" 
                     style="max-width: 250px; max-height: 200px;" 
                     onload="positionLogo(this)">
            </div>
        <% } %>
        
        <div id="heroText" class="<%= primaryLogo ? '' : 'text-center' %>" style="<%= primaryLogo ? 'overflow: auto;' : '' %>">
            <% if (band.tagline) { %>
                <p class="tagline mb-3"><%= band.tagline %></p>
            <% } %>
            <% if (band.hometown) { %>
                <p class="mb-2"><i class="bi bi-geo-alt"></i> <%= band.hometown %></p>
            <% } %>
            <% if (band.genres) { %>
                <p class="mb-0"><i class="bi bi-music-note-beamed"></i> <%= band.genres %></p>
            <% } %>
        </div>
    </div>
</div>

<script>
function positionLogo(img) {
    const width = img.naturalWidth;
    const height = img.naturalHeight;
    const aspectRatio = width / height;
    
    const heroContainer = document.getElementById('heroContainer');
    const logoContainer = document.getElementById('logoContainer');
    const heroText = document.getElementById('heroText');
    const heroSection = document.querySelector('.hero-section');
    
    let maxWidth, maxHeight;
    
    // Banner logo (wide) - aspect ratio > 2.5
    if (aspectRatio > 2.5) {
        // Center horizontally, full width
        heroContainer.className = 'container';
        logoContainer.className = 'text-center mb-4';
        logoContainer.style.float = 'none';
        maxWidth = 800;
        maxHeight = 150;
        img.style.maxWidth = maxWidth + 'px';
        img.style.maxHeight = maxHeight + 'px';
        img.style.margin = '0 auto';
        heroText.className = 'text-center';
    } 
    // Square or portrait logo - aspect ratio <= 2.5
    else {
        // Create side-by-side layout on larger screens
        heroContainer.className = 'container';
        logoContainer.className = 'float-start me-4 mb-3';
        maxWidth = 250;
        maxHeight = 200;
        img.style.maxWidth = maxWidth + 'px';
        img.style.maxHeight = maxHeight + 'px';
        heroText.className = '';
        
        // On mobile, stack vertically
        if (window.innerWidth < 768) {
            logoContainer.className = 'text-center mb-3';
            logoContainer.style.float = 'none';
            heroText.className = 'text-center';
        }
    }
    
    // Calculate actual displayed dimensions
    let displayedWidth, displayedHeight;
    
    // Scale to fit within max constraints while preserving aspect ratio
    const widthScale = maxWidth / width;
    const heightScale = maxHeight / height;
    const scale = Math.min(widthScale, heightScale, 1); // Don't upscale
    
    displayedWidth = width * scale;
    displayedHeight = height * scale;
    
    // Set hero section min-height based on DISPLAYED logo height only
    // The padding (30px top + 30px bottom) is already in CSS
    // Text height will add naturally - no need to force extra space
    const minHeight = displayedHeight + 60; // displayed logo + CSS padding
    heroSection.style.minHeight = minHeight + 'px';
}

// Handle window resize for responsive layout
window.addEventListener('resize', function() {
    const img = document.getElementById('primaryLogo');
    if (img) {
        positionLogo(img);
    }
});
</script>

    <div class="container mb-5">
        <!-- Bio Section -->
        <% if (band.bio || band.description) { %>
        <section class="mb-5">
            <h2 class="section-title">About <%= band.name %></h2>
            <div class="lead">
                <%= band.bio || band.description %>
            </div>
            <% if (band.genres) { %>
                <p class="mt-3">
                    <strong>Genre:</strong> <%= band.genres %>
                </p>
            <% } %>
            <% if (band.formedYear) { %>
                <p>
                    <strong>Formed:</strong> <%= band.formedYear %>
                </p>
            <% } %>
        </section>
        <% } %>

        <!-- Members Section -->
        <% if (band.showMembers && band.members && band.members.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Band Members</h2>
            <div class="row">
                <% band.members.forEach(member => { %>
                    <div class="col-md-3 col-sm-6">
                        <div class="member-card">
                            <% if (member.photoUrl) { %>
                                <img src="<%= member.photoUrl %>" alt="<%= member.displayName || member.user.username %>">
                            <% } else { %>
                                <div class="bg-secondary text-white d-flex align-items-center justify-content-center" style="width: 150px; height: 150px; border-radius: 50%; margin: 0 auto 15px;">
                                    <i class="bi bi-person-fill" style="font-size: 4rem;"></i>
                                </div>
                            <% } %>
                            
                            <% if (member.user.slug && member.user.isPublic) { %>
                                <h5>
                                    <a href="/musicians/<%= member.user.slug %>" class="text-decoration-none">
                                        <%= member.displayName || member.user.username %>
                                    </a>
                                </h5>
                            <% } else { %>
                                <h5><%= member.displayName || member.user.username %></h5>
                            <% } %>
                            
                            <% if (member.instrument) { %>
                                <p class="text-muted"><%= member.instrument %></p>
                            <% } %>
                            <% if (member.isFeatured) { %>
                                <span class="badge bg-warning">Featured Artist</span>
                            <% } %>
                        </div>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Performance Photos Section -->
        <% 
        const performancePhotos = band.photos && band.photos.filter(p => p.category === 'performance');
        %>
        <% if (performancePhotos && performancePhotos.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Performance Photos</h2>
            <div class="photo-grid">
                <% performancePhotos.forEach(photo => { %>
                    <div class="photo-card">
                        <img src="<%= photo.filePath %>" alt="<%= photo.caption || band.name %>">
                        <% if (photo.caption) { %>
                            <p class="mt-2"><%= photo.caption %></p>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Event Posters Section -->
        <% 
        const posters = band.photos && band.photos.filter(p => p.category === 'poster');
        %>
        <% if (posters && posters.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Event Posters</h2>
            <div class="photo-grid">
                <% posters.forEach(photo => { %>
                    <div class="photo-card">
                        <img src="<%= photo.filePath %>" alt="<%= photo.caption || band.name %>">
                        <% if (photo.caption) { %>
                            <p class="mt-2"><%= photo.caption %></p>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Promo Shots Section -->
        <% 
        const promoPhotos = band.photos && band.photos.filter(p => p.category === 'promo');
        %>
        <% if (promoPhotos && promoPhotos.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Promo Shots</h2>
            <div class="photo-grid">
                <% promoPhotos.forEach(photo => { %>
                    <div class="photo-card">
                        <img src="<%= photo.filePath %>" alt="<%= photo.caption || band.name %>">
                        <% if (photo.caption) { %>
                            <p class="mt-2"><%= photo.caption %></p>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- General Photos Section -->
        <% 
        const generalPhotos = band.photos && band.photos.filter(p => !p.category || p.category === '');
        %>
        <% if (generalPhotos && generalPhotos.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Photos</h2>
            <div class="photo-grid">
                <% generalPhotos.forEach(photo => { %>
                    <div class="photo-card">
                        <img src="<%= photo.filePath %>" alt="<%= photo.caption || band.name %>">
                        <% if (photo.caption) { %>
                            <p class="mt-2"><%= photo.caption %></p>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Logos Section -->
        <% 
        const logos = band.photos && band.photos.filter(p => p.category === 'logo');
        %>
        <% if (logos && logos.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Band Logos</h2>
            <p class="text-muted mb-4">Click any logo to download the full resolution version</p>
            <div class="row g-4">
                <% logos.forEach(logo => { %>
                    <div class="col-md-4 col-sm-6 text-center">
                        <a href="<%= logo.filePath %>" download class="text-decoration-none">
                            <div class="card h-100 logo-card" style="transition: transform 0.2s;">
                                <div class="card-body d-flex flex-column justify-content-center" style="min-height: 200px;">
                                    <img src="<%= logo.filePath %>" alt="<%= logo.caption || band.name + ' Logo' %>" 
                                         style="max-width: 100%; max-height: 180px; object-fit: contain;">
                                </div>
                                <div class="card-footer bg-light">
                                    <small><i class="bi bi-download"></i> <%= logo.caption || 'Download Logo' %></small>
                                    <% if (logo.isPrimary) { %>
                                        <br><span class="badge bg-primary mt-1">Primary Logo</span>
                                    <% } %>
                                </div>
                            </div>
                        </a>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Videos Section -->
        <% if (band.videos && band.videos.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Videos</h2>
            <div class="row">
                <% band.videos.forEach(video => { %>
                    <div class="col-md-6 mb-4">
                        <h5><%= video.title %></h5>
                        <% if (video.youtubeUrl) { %>
                            <% 
                            const url = video.youtubeUrl;
                            const isYouTube = url.includes('youtube.com') || url.includes('youtu.be');
                            const isVideoFile = /\.(mov|mp4|webm|avi|m4v)(\?|$)/i.test(url);
                            
                            if (isYouTube) {
                                // YouTube embed
                                let embedUrl = url;
                                if (embedUrl.includes('watch?v=')) {
                                    embedUrl = embedUrl.replace('watch?v=', 'embed/');
                                } else if (embedUrl.includes('youtu.be/')) {
                                    embedUrl = embedUrl.replace('youtu.be/', 'youtube.com/embed/');
                                }
                                embedUrl = embedUrl.split('&')[0];
                            %>
                                <div class="ratio ratio-16x9 mb-2">
                                    <iframe src="<%= embedUrl %>" allowfullscreen 
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
                                </div>
                            <% } else if (isVideoFile) { %>
                                <!-- Direct video file -->
                                <video controls class="w-100 mb-2" style="max-height: 400px; background: #000;">
                                    <source src="<%= url %>">
                                    Your browser does not support video playback.
                                </video>
                            <% } else { %>
                                <!-- Other URL - provide link to open -->
                                <div class="mb-2">
                                    <a href="<%= url %>" target="_blank" class="btn btn-primary">
                                        <i class="bi bi-play-circle"></i> Watch Video
                                    </a>
                                </div>
                            <% } %>
                        <% } else if (video.filePath) { %>
                            <video controls class="w-100 mb-2" style="max-height: 400px; background: #000;">
                                <source src="<%= video.filePath %>">
                                Your browser does not support video playback.
                            </video>
                        <% } %>
                        <% if (video.description) { %>
                            <p class="text-muted small"><%= video.description %></p>
                        <% } %>
                    </div>
                <% }) %>
            </div>
        </section>
        <% } %>

        <!-- Audio Section -->
        <% if (band.audioSamples && band.audioSamples.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Audio Samples</h2>
            <% band.audioSamples.forEach(audio => { %>
                <div class="mb-3">
                    <h5><%= audio.title %></h5>
                    <% if (audio.filePath) { %>
                        <audio controls class="w-100">
                            <source src="<%= audio.filePath %>">
                        </audio>
                    <% } else if (audio.externalUrl) { %>
                        <p><a href="<%= audio.externalUrl %>" target="_blank" class="btn btn-primary">
                            <i class="bi bi-music-note"></i> Listen
                        </a></p>
                    <% } %>
                    <% if (audio.description) { %>
                        <p class="text-muted"><%= audio.description %></p>
                    <% } %>
                </div>
            <% }) %>
        </section>
        <% } %>

        <!-- Press Quotes Section -->
        <% if (band.pressQuotes && band.pressQuotes.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Press & Reviews</h2>
            <% band.pressQuotes.forEach(quote => { %>
                <div class="press-quote">
                    <blockquote>"<%= quote.quote %>"</blockquote>
                    <p class="mb-0"><strong><%= quote.attribution %></strong></p>
                    <% if (quote.source) { %>
                        <p class="text-muted mb-0"><%= quote.source %></p>
                    <% } %>
                </div>
            <% }) %>
        </section>
        <% } %>

        <!-- Upcoming Gigs Section -->
        <% if (band.showGigs && band.gigs && band.gigs.length > 0) { %>
        <section class="mb-5">
            <h2 class="section-title">Upcoming Shows</h2>
            <% band.gigs.forEach(gig => { %>
                <div class="gig-card">
                    <h5><%= gig.name %></h5>
                    <p class="mb-1">
                        <i class="bi bi-calendar"></i> 
                        <%= new Date(gig.gigDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) %>
                    </p>
                    <% if (gig.venue) { %>
                        <p class="mb-1">
                            <i class="bi bi-geo-alt"></i> <%= gig.venue.name %>
                            <% if (gig.venue.city) { %>, <%= gig.venue.city %><% } %>
                        </p>
                    <% } %>
                    <% if (gig.ticketLink) { %>
                        <a href="<%= gig.ticketLink %>" target="_blank" class="btn btn-sm btn-primary">Get Tickets</a>
                    <% } %>
                </div>
            <% }) %>
        </section>
        <% } %>

        <!-- Contact & Social Section -->
        <section class="mb-5 text-center">
            <h2 class="section-title">Connect</h2>
            
            <!-- Social Links -->
            <% if (band.socialLinks && band.socialLinks.length > 0) { %>
                <div class="social-links mb-4">
                    <% band.socialLinks.forEach(social => { %>
                        <a href="<%= social.url %>" target="_blank" 
                           title="<%= social.platform.charAt(0).toUpperCase() + social.platform.slice(1) %><%= social.handle ? ' - ' + social.handle : '' %>">
                            <% if (social.platform === 'facebook') { %>
                                <i class="bi bi-facebook"></i>
                            <% } else if (social.platform === 'instagram') { %>
                                <i class="bi bi-instagram"></i>
                            <% } else if (social.platform === 'twitter') { %>
                                <i class="bi bi-twitter"></i>
                            <% } else if (social.platform === 'youtube') { %>
                                <i class="bi bi-youtube"></i>
                            <% } else if (social.platform === 'spotify') { %>
                                <i class="bi bi-spotify"></i>
                            <% } else if (social.platform === 'soundcloud') { %>
                                <i class="bi bi-cloud"></i>
                            <% } else if (social.platform === 'bandcamp') { %>
                                <i class="bi bi-vinyl"></i>
                            <% } else if (social.platform === 'tiktok') { %>
                                <i class="bi bi-tiktok"></i>
                            <% } else if (social.platform === 'website') { %>
                                <i class="bi bi-globe"></i>
                            <% } else { %>
                                <i class="bi bi-link-45deg"></i>
                            <% } %>
                        </a>
                    <% }) %>
                </div>
            <% } %>

            <!-- Booking Contact -->
            <% if (band.contactEmail) { %>
                <p class="mb-2">
                    <strong>Booking:</strong> 
                    <a href="mailto:<%= band.contactEmail %>"><%= band.contactEmail %></a>
                </p>
            <% } %>
            <% if (band.contactPhone) { %>
                <p class="mb-2">
                    <strong>Phone:</strong> <%= band.contactPhone %>
                </p>
            <% } %>
            
            <!-- Action Buttons -->
            <div class="mt-4">
                <% if (band.websiteUrl) { %>
                    <a href="<%= band.websiteUrl %>" target="_blank" class="btn btn-outline-primary me-2">
                        <i class="bi bi-globe"></i> Visit Website
                    </a>
                <% } %>
                
                <!-- Band Member Only Buttons -->
                <% if (isBandMember) { %>
                    <a href="/bands/<%= band.id %>/edit#public-page" class="btn btn-warning me-2">
                        <i class="bi bi-pencil"></i> Edit Page
                    </a>
                    <a href="/bands/<%= band.id %>" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left"></i> Back to Band
                    </a>
                <% } %>
            </div>
        </section>
    </div>

