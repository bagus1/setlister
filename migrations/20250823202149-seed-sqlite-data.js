"use strict";

/** @type {import('sequelize-cli').Migration} */
module.exports = {
  async up(queryInterface, Sequelize) {
    // This migration will import data from our SQLite migration files
    // We'll use the files generated by migrate-sqlite-to-postgres.js

    console.log("üì• Starting data import from SQLite migration files...");

    // Note: In a real migration, you would read the SQL files and execute them
    // For now, this is a placeholder that shows the structure

    // The actual data import would happen by:
    // 1. Reading the migration-output/*.sql files
    // 2. Parsing the INSERT statements
    // 3. Using queryInterface.bulkInsert() to import data

    console.log("‚úÖ Data import migration completed (placeholder)");
    console.log(
      "üìã To import actual data, run: node migrate-sqlite-to-postgres.js"
    );
    console.log(
      "üìã Then use the generated SQL files or convert them to bulkInsert calls"
    );
  },

  async down(queryInterface, Sequelize) {
    // Remove all imported data
    console.log("üóëÔ∏è  Removing imported data...");

    // Clear all tables in reverse dependency order
    await queryInterface.bulkDelete("song_artists", null, {});
    await queryInterface.bulkDelete("links", null, {});
    await queryInterface.bulkDelete("password_resets", null, {});
    await queryInterface.bulkDelete("band_invitations", null, {});
    await queryInterface.bulkDelete("medley_songs", null, {});
    await queryInterface.bulkDelete("medleys", null, {});
    await queryInterface.bulkDelete("setlist_songs", null, {});
    await queryInterface.bulkDelete("setlist_sets", null, {});
    await queryInterface.bulkDelete("setlists", null, {});
    await queryInterface.bulkDelete("band_songs", null, {});
    await queryInterface.bulkDelete("gig_documents", null, {});
    await queryInterface.bulkDelete("artists", null, {});
    await queryInterface.bulkDelete("songs", null, {});
    await queryInterface.bulkDelete("vocalists", null, {});
    await queryInterface.bulkDelete("band_members", null, {});
    await queryInterface.bulkDelete("bands", null, {});
    await queryInterface.bulkDelete("users", null, {});

    console.log("‚úÖ All imported data removed");
  },
};
