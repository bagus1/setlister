<div class="container-fluid py-4">
  <!-- Header with band context -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2><i class="bi bi-music-note"></i> Add a Song</h2>
          <p class="text-muted mb-0">
            Add a new song to <strong><%= band.name %></strong>'s repertoire
          </p>
        </div>
        <a href="/bands/<%= band.id %>" class="btn btn-outline-secondary">
          <i class="bi bi-arrow-left"></i> Back to Band
        </a>
      </div>
    </div>
  </div>

  <!-- Main form -->
  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-body">
          <form action="/bands/<%= band.id %>/songs/new" method="POST">
            <!-- Basic song info -->
            <div class="row mb-4">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="title" class="form-label">Song Title *</label>
                  <input type="text" class="form-control" id="title" name="title" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="artist" class="form-label">Artist (Optional)</label>
                  <input type="text" class="form-control" id="artist" name="artist"
                         list="artistsList" placeholder="Start typing artist name...">
                  <datalist id="artistsList">
                    <% if (typeof artists !== 'undefined') { %>
                      <% artists.forEach(artist => { %>
                        <option value="<%= artist.name %>">
                      <% }) %>
                    <% } %>
                  </datalist>
                </div>
              </div>
            </div>

            <!-- Gig document editor -->
            <div class="mb-4">
              <label for="content" class="form-label">Gig Document (Optional)</label>
              <textarea id="editor" name="content" style="height: 400px;"></textarea>
              <div class="form-text">Add chords, lyrics, or other content for this song</div>
            </div>

            <!-- Document type -->
            <div class="mb-4">
              <label for="docType" class="form-label">Document Type</label>
              <select class="form-select" id="docType" name="docType">
                <option value="">Select document type...</option>
                <option value="chords" selected>Chords</option>
                <option value="bass-tab">Bass Tab</option>
                <option value="guitar-tab">Guitar Tab</option>
                <option value="lyrics">Lyrics</option>
              </select>
            </div>

            <!-- Submit buttons -->
            <div class="d-flex justify-content-between">
              <a href="/bands/<%= band.id %>" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Cancel
              </a>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-plus"></i> Add Song
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Sidebar with tips -->
    <div class="col-md-4">
      <div class="card bg-light">
        <div class="card-body">
          <h6 class="card-title">
            <i class="bi bi-info-circle"></i> Tips
          </h6>
          <ul class="small">
            <li>Use the table button to create structured layouts</li>
            <li>Apply monospace font to preserve spacing in tables</li>
            <li>Use headers to organize your content</li>
            <li>Save frequently to avoid losing changes</li>
          </ul>

          <h6 class="card-title mt-3">
            <i class="bi bi-lightbulb"></i> What happens?
          </h6>
          <p class="small">
            This will create a new song and add it to <strong><%= band.name %></strong>'s repertoire. 
            If you add content above, it will also create a gig document for the song.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- TinyMCE -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.8.3/tinymce.min.js"></script>
<script src="/js/gig-document-editor.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Initialize the shared editor
    const editor = new GigDocumentEditor('editor', {
      formSelector: 'form'
    });
  });
</script>
